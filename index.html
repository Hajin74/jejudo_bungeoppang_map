<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="Keywords" content="제주도 붕어빵 지도, 붕어빵, 제주도" />
    <link rel="shortcut icon" href="bungeoppang.png">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@700&family=Song+Myung&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="style.css">
    <title>제주도 붕어빵 지도</title>
</head>
<body>
    <div class = "bungeoppang_map_top">
        <div class = "bungeoppang_map_top_menu">
            <i class="fas fa-bars"></i>
        </div>
        <div class = "bungeoppang_map_top_title">
            <h1>제주도 붕어빵 지도</h1> 
        </div>
        <div class = "bungeoppang_map_top_info">
            <i class="fas fa-info-circle"></i>
            <div class = "info">개발 중입니다.</div>
        </div>
    </div>

    <script>
       // var $info = document.getElementsByClassName('info');

    </script>

    <div class = "bungeoppang_map_main">
        <div id="map" style="width:100%;height:100%;"></div>
    </div>

	<script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=e76cc4903ec63f90d16bc8a188b95500&libraries=clusterer"></script>
	<script>
		var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
		    mapOption = {
		        center: new kakao.maps.LatLng(33.505196, 126.525845), // 지도의 중심좌표
		        level: 6, // 지도의 확대 레벨
		        mapTypeId : kakao.maps.MapTypeId.ROADMAP // 지도종류
		    }; 

		// 지도를 생성한다 
		var map = new kakao.maps.Map(mapContainer, mapOption); 

        // 마커 클러스터러를 생성
        var clusterer = new kakao.maps.MarkerClusterer({
            map: map, // 마커들을 클러스터로 관리하고 표시할 지도 객체 
            averageCenter: true, // 클러스터에 포함된 마커들의 평균 위치를 클러스터 마커 위치로 설정 
            minLevel: 10 // 클러스터 할 최소 지도 레벨 
        });
        // 데이터 저장
        var 데이터 = [
            [33.519552, 126.574247, '<div style="padding:5px;">동화초 붕어빵</div>'],
            [33.514362, 126.574475, '<div style="padding:5px;">LH2단지 농협 옆 붕어빵</div>'],
            [33.511944, 126.581770, '<div style="padding:5px;">제일상사옆 로또판매점 붕어빵</div>'],
            [33.538098, 126.639783, '<div style="padding:5px;">교회 앞 붕어빵</div>'],
            [33.499737, 126.529711, '<div style="padding:5px;">시청 붕어빵</div>'],
            [33.507231, 126.529612, '<div style="padding:5px;">기산아파트 옆 마트 붕어빵</div>'],
            [33.481494, 126.485288, '<div style="padding:5px;">노형 아이파크밑 사거리 붕어빵</div>'],
            [33.500095, 126.526017, '<div style="padding:5px;">도남 주차장 앞 붕어빵</div>'],
            [33.492267, 126.484867, '<div style="padding:5px;">신광초 아래 붕어빵</div>'],
            [33.538236, 126.639150, '<div style="padding:5px;">혼모심사우나 뒤 붕어빵</div>'],
            [33.508924, 126.510306, '<div style="padding:5px;">용문버스정류장 붕어빵</div>'],
            [33.485635, 126.431050, '<div style="padding:5px;">뚜레쥬르 아래 길가 붕어빵</div>'],
            [33.416167, 126.264663, '<div style="padding:5px;">한림매일장 붕어빵</div>'],
            [33.490500, 126.494604, '<div style="padding:5px;">모살물 붕어빵</div>'],
            [33.483086, 126.471134, '<div style="padding:5px;">베스트마트 옆 붕어빵</div>'],
            [33.487322, 126.534754, '<div style="padding:5px;">봉분식 붕어빵</div>'],
            [33.484959, 126.485034, '<div style="padding:5px;">숙성도 부근 붕어빵</div>'],
            [33.485138, 126.493346, '<div style="padding:5px;">뉴월드마트 붕어빵</div>'],
            [33.475183, 126.548757, '<div style="padding:5px;">과일가게 옆 붕어빵</div>'],
            [33.503702, 126.552866, '<div style="padding:5px;">하나로마트 붕어빵</div>'],
            [33.483839, 126.491041, '<div style="padding:5px;">노블레스호텔 붕어빵</div>'],
            [33.248546, 126.563528, '<div style="padding:5px;">제주은행 붕어빵</div>'],
            [33.270877, 126.589936, '<div style="padding:5px;">마을회관 붕어빵</div>'],
            [33.521303, 126.565983, '<div style="padding:5px;">이순애 순대국밥 붕어빵</div>'],
            [33.537481, 126.619981, '<div style="padding:5px;">선창식당 붕어빵</div>'],
            [33.495849, 126.537582, '<div style="padding:5px;">남광마트 붕어빵</div>'],
            [33.505130, 126.514642, '<div style="padding:5px;">적십자 붕어빵</div>'],
            [33.485670, 126.499301, '<div style="padding:5px;">중앙중 앞 붕어빵</div>'],
            [33.496122, 126.525213, '<div style="padding:5px;">도남오거리 식당 붕어빵</div>'],
            [33.492367, 126.434056, '<div style="padding:5px;">소보록 붕어빵</div>'],
            [33.473840, 126.545916, '<div style="padding:5px;">구름 카스테라 붕어빵</div>'],
            [33.512857, 126.528038, '<div style="padding:5px;">동문시장 다금바리빵</div>'],
            [33.483508, 126.537523, '<div style="padding:5px;">오뎅먹는 붕어빵</div>'],
            [33.473943, 126.542772, '<div style="padding:5px;">낭만상사 붕어빵</div>']
        ];

        var markers = [];

        for(var i = 0; i < 데이터.length; i++) {
            // 지도에 마커를 생성하고  표시한다
            var marker = new kakao.maps.Marker({
                position: new kakao.maps.LatLng(데이터[i][0], 데이터[i][1]),
                map: map // 마커를 표시할 지도 객체
            }); 
    
            var infowindow = new kakao.maps.InfoWindow({
                content: 데이터[i][2]
            });
    
            //infowindow.open(map, marker);
            markers.push(marker);

            kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
            kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));
        }

        //클러스터러에 마커들을 추가합니다
        clusterer.addMarkers(markers);

        // 인포윈도우를 표시하는 클로저를 만드는 함수입니다 
        function makeOverListener(map, marker, infowindow) {
            return function() {
                infowindow.open(map, marker);
            };
        }

        // 인포윈도우를 닫는 클로저를 만드는 함수입니다 
        function makeOutListener(infowindow) {
            return function() {
                infowindow.close();
            };
        }


        var content = '<div class="overlaybox">' +
            '<div class = "overlaybox1"><div>[상세정보]</div><button class="close" onclick="closeOverlay()" title="닫기">X</button></div>' +
            '<div class = "overlaybox2"><div>홈그라운드</div></div>' + 
            '</div>';

        // 커스텀 오버레이가 표시될 위치입니다 
        var position = new kakao.maps.LatLng(33.473943, 126.542772);  //낭만상사

        // 커스텀 오버레이를 생성합니다
        var customOverlay = new kakao.maps.CustomOverlay({
            position: position,
            content: content,
            xAnchor: 0.3,
            yAnchor: 0.91
        });

        //customOverlay.setMap(map); // 업로드 되자마자 열기

        // 마커를 클릭했을 때 커스텀 오버레이를 표시합니다
        kakao.maps.event.addListener(marker, 'click', function() {
            customOverlay.setMap(map);
        });

        function closeOverlay() {
            customOverlay.setMap(null);
        }
    </script>
    <script src="https://kit.fontawesome.com/6478f529f2.js" crossorigin="anonymous"></script>
</body>
</html>